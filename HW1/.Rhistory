ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "steelblue", size = 2.5, alpha = 0.8) +
# Regression line (extended)
geom_smooth(method = "lm", fullrange = TRUE, se = TRUE,
color = "darkblue", fill = "lightblue", linewidth = 1.2) +
# Red points from the second dataframe
geom_point(data = futurepop, aes(year, linear),
color = "red", size = 3.5, shape = 17) +
geom_point(data = futurepop, aes(year, qu),
color = "green", size = 3.5, shape = 17)+
geom_point(data = futurepop, aes(year, lag),
color = "blue", size = 3.5, shape = 17)+
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Fitted Linear Trend with Additional Observations",
x = "Year",
y = "Population",
caption = "Blue = main data | Red = Linear Model Prediction | Green = Quadric Model Prediction"
) +
# Better axis and theme
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = scales::comma) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# Example plot
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "steelblue", size = 2.5, alpha = 0.8) +
# Regression line (extended)
geom_smooth(method = "lm", fullrange = TRUE, se = TRUE,
color = "darkblue", fill = "lightblue", linewidth = 1.2) +
# Red points from the second dataframe
geom_point(data = futurepop, aes(year, linear),
color = "red", size = 1.5, shape = 17) +
geom_point(data = futurepop, aes(year, qu),
color = "green", size = 1.5, shape = 17)+
geom_point(data = futurepop, aes(year, lag),
color = "blue", size = 1.5, shape = 17)+
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Fitted Linear Trend with Additional Observations",
x = "Year",
y = "Population",
caption = "Blue = main data | Red = Linear Model Prediction | Green = Quadric Model Prediction"
) +
# Better axis and theme
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = scales::comma) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# Example plot
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "steelblue", size = 2.5, alpha = 0.8) +
# Regression line (extended)
geom_smooth(method = "lm", fullrange = TRUE, se = TRUE,
color = "darkblue", fill = "lightblue", linewidth = 1.2) +
# Red points from the second dataframe
geom_point(data = futurepop, aes(year, linear),
color = "red", size = 2.5, shape = 17) +
geom_point(data = futurepop, aes(year, qu),
color = "green", size = 2.5, shape = 17)+
geom_point(data = futurepop, aes(year, lag),
color = "blue", size = 2.5, shape = 17)+
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Fitted Linear Trend with Additional Observations",
x = "Year",
y = "Population",
caption = "Blue = main data | Red = Linear Model Prediction | Green = Quadric Model Prediction"
) +
# Better axis and theme
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = scales::comma) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# Example plot
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "steelblue", size = 2.5, alpha = 0.8) +
# Regression line (extended)
geom_smooth(method = "lm", fullrange = TRUE, se = TRUE,
color = "darkblue", fill = "lightblue", linewidth = 1.2) +
# Red points from the second dataframe
geom_point(data = futurepop, aes(year, linear),
color = "red", size = 2.5, shape = 17) +
geom_point(data = futurepop, aes(year, qu),
color = "green", size = 2.5, shape = 17)+
geom_point(data = futurepop, aes(year, lag),
color = "yellow", size = 2.5, shape = 17, alpha = 0.5)+
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Fitted Linear Trend with Additional Observations",
x = "Year",
y = "Population",
caption = "Blue = main data | Red = Linear Model Prediction | Green = Quadric Model Prediction | Yellow = Lag Model Prediction"
) +
# Better axis and theme
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = scales::comma) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# Example plot
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "steelblue", size = 2.5, alpha = 0.8) +
# Regression line (extended)
geom_smooth(method = "lm", fullrange = TRUE, se = TRUE,
color = "darkblue", fill = "lightblue", linewidth = 1.2) +
# Red points from the second dataframe
geom_point(data = futurepop, aes(year, linear),
color = "red", size = 2.5, shape = 17) +
geom_point(data = futurepop, aes(year, qu),
color = "green", size = 2.5, shape = 17)+
geom_point(data = futurepop, aes(year, lag),
color = "yellow", size = 2.5, shape = 17, alpha = 0.5)+
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Fitted Linear Trend with Additional Observations",
x = "Year",
y = "Population",
caption = "Blue = main data | Red = Linear Model Prediction | Green = Quadric Model Prediction | Yellow = Lag Model Prediction"
) +
# Better axis and theme
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = scales::comma) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "#2C7BB6", size = 3, alpha = 0.9) +
# Regression line (extended)
geom_smooth(
method = "lm", fullrange = TRUE, se = TRUE,
color = "#1D4E89", fill = "#A6CEE3", linewidth = 1.2
) +
# Future prediction points
geom_point(data = futurepop, aes(year, linear, color = "Linear Model"),
size = 3, shape = 17) +
geom_point(data = futurepop, aes(year, qu, color = "Quadratic Model"),
size = 3, shape = 17) +
geom_point(data = futurepop, aes(year, lag, color = "Lag Model"),
size = 3, shape = 17, alpha = 0.8) +
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Historical Data and Model-Based Predictions",
x = "Year",
y = "Population",
color = "Model Type",
caption = "Blue points = observed data; triangles = model predictions"
) +
# Axis formatting
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = comma) +
# Manually define colors for consistency
scale_color_manual(values = c(
"Linear Model" = "red",
"Quadratic Model" = "green3",
"Lag Model" = "goldenrod"
)) +
# Minimal, clean theme
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
legend.position = "top",
legend.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
library(scales)
ggplot(population, aes(year, population)) +
# Main data points
geom_point(color = "#2C7BB6", size = 3, alpha = 0.9) +
# Regression line (extended)
geom_smooth(
method = "lm", fullrange = TRUE, se = TRUE,
color = "#1D4E89", fill = "#A6CEE3", linewidth = 1.2
) +
# Future prediction points
geom_point(data = futurepop, aes(year, linear, color = "Linear Model"),
size = 3, shape = 17) +
geom_point(data = futurepop, aes(year, qu, color = "Quadratic Model"),
size = 3, shape = 17) +
geom_point(data = futurepop, aes(year, lag, color = "Lag Model"),
size = 3, shape = 17, alpha = 0.8) +
# Labels and title
labs(
title = "Population Change Over Time",
subtitle = "Historical Data and Model-Based Predictions",
x = "Year",
y = "Population",
color = "Model Type",
caption = "Blue points = observed data; triangles = model predictions"
) +
# Axis formatting
scale_x_continuous(expand = expansion(mult = c(0.02, 0.05))) +
scale_y_continuous(labels = comma) +
# Manually define colors for consistency
scale_color_manual(values = c(
"Linear Model" = "red",
"Quadratic Model" = "green3",
"Lag Model" = "goldenrod"
)) +
# Minimal, clean theme
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 13, color = "gray40"),
axis.title = element_text(face = "bold"),
legend.position = "top",
legend.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
library(tidycensus)
test=load_variables(2023,"acs5")
View(test)
library(arrow)
library(dplyr)
data_dir <- "C:/Users/wensh/Downloads/HomeValueData/HomeValueData"
dataset <- open_dataset(data_dir, format = "parquet")
df <- dataset %>%
collect()
colnames(df)
write.csv(df,"C:/Users/wensh/Downloads/housing_value")
View(df)
library(lubridate)
filter(year>2018|year<2024)
filter(between(year,2018,2023))
df_filtered=df%>%
mutate(year=year(as.Date(ASSESSORPRIORSALEDATE)))%>%
filter(between(year,2018,2023))
df_filtered=df%>%
mutate(year=year(as.Date(ASSESSORPRIORSALEDATE)))
View(df_filtered)
df_filtered=df%>%
mutate(year=year(ASSESSORPRIORSALEDATE))
colnames(df)
df_filtered=df%>%
filter(TAXMARKETVALUETOTAL!==0)
df_filtered=df%>%
filter(TAXMARKETVALUETOTAL!=0)
print(median(df_filtered$TAXASSESSEDVALUETOTAL))
colnames(df)
df_filtered=df%>%
filter(TAXMARKETVALUETOTAL!=0)%>%
mutate(year=year(ymd(ASSESSORLASTSALEDATE)))%>%
filter(between(year,2019,2023))
View(df_filtered)
df_filtered=df%>%
mutate(year=year(ymd(ASSESSORLASTSALEDATE)))%>%
filter(between(year,2019,2023))
df_filtered=df%>%
mutate(year=year(ymd(ASSESSORLASTSALEDATE)))%>%
filter(between(year,2019,2023))%>%
filter(ASSESSORLASTSALEAMOUNT!=0)
View(df_filtered)
hw1=read.csv("C:/Users/wensh/Downloads/RegressionData.csv")
library(stargazer)
stargazer(hw1,out="txt")
stargazer(hw1,out="text")
stargazer(hw1,out="html",out="C:/Users/wensh/Downloads/RegressionData.html")
stargazer(hw1,out="C:/Users/wensh/Downloads/RegressionData.html")
library(Hmisc)
library(c(DAAG,car,MASS,rsq,caret))
library(DAAG)
install.packages("DAAG")
library(car)
library(dplyr)
library(hmisc)
library(Hmisc)
library(tidyverse)
library(xml2)
# Read the file
doc <- read_xml("C:/Users/wensh/Downloads/IL_StateDataSet.xml")
# Define the NEMSIS namespace
ns <- c(nemsis = "http://www.nemsis.org")
# View top-level structure
xml_name(doc)
xml_children(doc)
# Extract all agency groups
agencies <- xml_find_all(doc, ".//nemsis:sAgencyGroup", ns)
# Pull specific fields into a data frame
agency_df <- data.frame(
id     = xml_text(xml_find_first(agencies, "nemsis:sAgency.01", ns)),
number = xml_text(xml_find_first(agencies, "nemsis:sAgency.02", ns)),
name   = xml_text(xml_find_first(agencies, "nemsis:sAgency.03", ns)),
stringsAsFactors = FALSE
)
head(agency_df)
View(agencies)
View(agency_df)
# Extract all facility sub-groups (hospitals)
facilities <- xml_find_all(doc, ".//nemsis:sFacility.FacilityGroup", ns)
facility_df <- data.frame(
name    = xml_text(xml_find_first(facilities, "nemsis:sFacility.02", ns)),
code    = xml_text(xml_find_first(facilities, "nemsis:sFacility.03", ns)),
address = xml_text(xml_find_first(facilities, "nemsis:sFacility.07", ns)),
state   = xml_text(xml_find_first(facilities, "nemsis:sFacility.09", ns)),
zip     = xml_text(xml_find_first(facilities, "nemsis:sFacility.10", ns)),
coords  = xml_text(xml_find_first(facilities, "nemsis:sFacility.13", ns)),
phone   = xml_text(xml_find_first(facilities, "nemsis:sFacility.15", ns)),
stringsAsFactors = FALSE
)
head(facility_df)
# Get every unique element name in the entire document
all_nodes <- xml_find_all(doc, ".//*")
unique_elements <- sort(unique(xml_name(all_nodes)))
print(unique_elements)
length(unique_elements)  # total count of unique tags
setwd("C:/Users/wensh/Desktop/MUSA5000/HW1")
data=read.csv("RegressionData")
data=read.csv("RegressionData.csv")
library(dplyr)
library(stargazer)
stargazer(data,out = "text")
stargazer(data,out = "html")
output=stargazer(data,out = "text")
output=stargazer(data,type = "text")
data=data%>%
mutate(
LNMEDHVAL=log(MEDHVAL),
LNPCBACHMORE=log(PCTBACHMOR+1),
LNNBELPOV100=log(NBELPOV100+1),
LNPCTVACANT=log(PCTVACANT+1),
LNPCTSINGLES=log(PCTSINGLES+1)
)
variable=c("MEDHVAL","PCTBACHMOR","NBELPOV100","PCTVACANT","PCTSINGLES")
variable=c("MEDHVAL","PCTBACHMOR","NBELPOV100","PCTVACANT","PCTSINGLES")
for v in variable{
for (v in variable){
for (v in variable) {
hist(data[[v]], main = paste("Histogram of", v), xlab = v)
}
print(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
for (v in variable) {
print(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
variable=c("MEDHVAL","PCTBACHMOR","NBELPOV100","PCTVACANT","PCTSINGLES")
for (v in variables) {
print(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
for (v in variables) {
output=list(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
for (v in variables) {
output=list(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
hist(data$MEDHVAL)
hist(data$MEDHVAL)
for (v in variables) {
output=list(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
for (v in variable) {
output=list(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
lnvariable=c("LNMEDHVAL","LNPCBACHMORE","LNNBELPOV100","LNPCTVACANT","LNPCTSINGLES")
for (v in lnvariable) {
print(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
for (v in lnvariable) {
output=list(hist(data[[v]], main = paste("Histogram of", v), xlab = v))
}
for (v in lnvariable) {
hist(data[[v]], main = paste("Histogram of", v), xlab = v)
}
for (v in variable) {
hist(data[[v]], main = paste("Histogram of", v), xlab = v)
}
for (v in lnvariable) {
hist(data[[v]], main = paste("Histogram of", v), xlab = v)
}
finalvariable=c("LNNBELPOV100","PCTBACHMOR","PCTVACANT","PCTSINGLES")
finalvariable=c("LNNBELPOV100","PCTBACHMOR","PCTVACANT","PCTSINGLES")
par(mfrow=c(2,2))
for (v in finalvairbale) {
plot(,data$LNMEDHVAL,data[[v]])
}
for (v in finalvaribale) {
plot(,data$LNMEDHVAL,data[[v]])
}
finalvariable=c("LNNBELPOV100","PCTBACHMOR","PCTVACANT","PCTSINGLES")
for (v in finalvariable) {
plot(,data$LNMEDHVAL,data[[v]])
}
plot(data$LNMEDHVAL,data[[v]])
dev.off()
par(mfrow=c(2,2))
for (v in finalvariable) {
plot(data$LNMEDHVAL,data[[v]])
}
for (v in finalvariable) {
plot(data$LNMEDHVAL,data[[v]],xlab = "log median home value",ylab = v)
}
for (v in finalvariable) {
plot(data$LNMEDHVAL,data[[v]],xlab = "LNMEDHVAL",ylab = v)
}
cor=list(cor(data$LNMEDHVAL,v))
cor=list(cor(data$LNMEDHVAL,data[[v]]))
View(cor)
for (v in finalvariable) {
plot(data$LNMEDHVAL,data[[v]],xlab = "LNMEDHVAL",ylab = v)
cor=list(cor(data$LNMEDHVAL,data[[v]]))
}
View(cor)
for (v in finalvariable) {
cor=list(cor(data$LNMEDHVAL,data[[v]]))
}
View(cor)
finalvariable=c("LNNBELPOV100","PCTBACHMOR","PCTVACANT","PCTSINGLES")
print(cor(data$LNMEDHVAL,data[[v]]))
for (v in finalvariable) {
print(cor(data$LNMEDHVAL,data[[v]]))
}
cor_data=data%>%
select("LNNBELPOV100","PCTBACHMOR","PCTVACANT","PCTSINGLES")
cor(cor_data)
library(rgdal)
install.packages("rgdal")
#install.packages("rgdal")
library(rgdal)
library(sf)
data_sf=st_read("shapefile/RegressionData.shp")
r1=lm(LNMEDHVAL~PCTVACANT+LNNBELPOV100+PCTBACHMOR+PCTSINGLES,data=data)
summary(r1)
anova(r1)
fitted(r1)
data$fittedvalue=fitted(r1)
data$residual=residuals(r1)
data$stdresidual=rstandard(r1)
View(data)
plot(data$fittedvalue,data$stdresidual)
par(mfrow=c(1,1))
plot(data$fittedvalue,data$stdresidual)
library(MASS)
step(r1)
step$anova(r1)
stepmodel=step(r1)
stepmodel$anova
install.packages("DAAG")
#install.packages("DAAG")
library(DAAG)
fullmodel=CVlm(
data=data,
form.lm = formula(LNMEDHVAL~PCTVACANT+LNNBELPOV100+PCTBACHMOR+PCTSINGLES),
k=5)
fullmodel=CVlm(
data=data,
form.lm = formula(LNMEDHVAL~PCTVACANT+LNNBELPOV100+PCTBACHMOR+PCTSINGLES),
m=5)
partmodel=CVlm(
data=data,
form.lm = formula(LNMEDHVAL~PCTVACANT+MEDHHINC),
m=5)
st_crs(data_sf)
data_sf=st_read("shapefile/RegressionData.shp")
View(data_sf)
View(data_sf[[14]][[1]])
data_sf=st_set_crs(data_sf,crs=2272)
data_sf=st_set_crs(data_sf,2272)
st_crs(data_sf)
library(ggplot2)
ggplot(data,aex(fill=LNMEDHVAL))+
geom_polygon(color = "black", linewidth = 0.2) +
scale_fill_continuous(low = "lightblue", high = "darkblue") +
theme_void()
ggplot(data,aes(fill=LNMEDHVAL))+
geom_polygon(color = "black", linewidth = 0.2) +
scale_fill_continuous(low = "lightblue", high = "darkblue") +
theme_void()
ggplot(data,aes(fill=LNMEDHVAL))+
geom_sf(color = "black", linewidth = 0.2) +
scale_fill_continuous(low = "lightblue", high = "darkblue") +
theme_void()
View(data_sf)
plot(data_sf)
ggplot(data_sf,aes(fill=LNMEDHVAL))+
geom_sf(color = "black", linewidth = 0.2) +
scale_fill_continuous(low = "lightblue", high = "darkblue") +
theme_void()
